---
title: "finalproject"
output: html_document
names: "Julia Van Goor, Joshua Strauss, Alex Yang"
---
## Set Working Directory
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "C:/Users/Owner/Documents/Group1_Bio201_FinalProject/")
```


## Load Packages
```{r Load packages, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE, results='hide'}
library(tidyverse)
library(readxl)
library(broom)
library(cowplot)
library(phyloseq)
library(vegan)
set.seed(7)
```

#Broad
### Tidy Data
#### Week 1 - Week 3 Change All
```{r}
but_wide <- all_data_wkly %>%
  rename_all(tolower) %>% 
  select(participant_id, semester, supplement_consumed, frequency, quantity_compliant, study_week, butyrate_mean) %>% #keep only columns of interest
  filter(study_week == "week1" | study_week == "week3", quantity_compliant == "yes") %>% #keep only weeks of interest, quantity compliant, and 1x
  spread(study_week, butyrate_mean) %>% 
  mutate(delta_butyrate = week3 - week1) #calculate difference in butyrate 

pro_wide <- all_data_wkly %>%
  rename_all(tolower) %>% 
  select(participant_id, semester, supplement_consumed, frequency, quantity_compliant, study_week, propionate_mean) %>% #keep only columns of interest
  filter(study_week == "week1" | study_week == "week3", quantity_compliant == "yes") %>% #keep only weeks of interest, quantity compliant, and 1x
  spread(study_week, propionate_mean) %>% 
  mutate(delta_propionate = week3 - week1) #calculate difference in propionate

delta_but_pro_wide <- inner_join(x = but_wide, y = pro_wide,
                    by = c("participant_id", 
                           "semester", "supplement_consumed", "frequency")) %>%
  select(-starts_with("week"), -starts_with("quantity_compliant"))

```
###Analysis
####Plot
```{r}
linear_correlation_plot<-delta_but_pro_wide %>%
  ggplot(aes(x = delta_butyrate,
             y = delta_propionate)) + 
  geom_point() + #puts data points to match x and y coordinates
  geom_smooth(method = "lm", #used to create a linear best fit line
              se = FALSE) + #hides confidence interval around line 
  xlab("Delta Butyrate (mmol/kg)") + 
  ylab("Delta Propionate (mmol/kg)") 
print(linear_correlation_plot)
```
####Assumptions
```{r}
nrow(delta_but_pro_wide) # sample size

shapiro.test(delta_but_pro_wide$delta_butyrate) #call column of df with values = vector 
shapiro.test(delta_but_pro_wide$delta_propionate) #call column of df with values = vector 

ggplot(delta_but_pro_wide, aes(x=delta_butyrate)) +
  geom_histogram() #histograms show the number of data points (count) at each value
ggplot(delta_but_pro_wide, aes(x=delta_propionate)) +
  geom_histogram() #histograms show the number of data points (count) at each value


```
####Test
```{r}
all_data_lm <- delta_but_pro_wide %>%
  lm(delta_butyrate ~ delta_propionate, data = .) #test relationship
summary(all_data_lm)
```

#By Supplement
##BRMPS
```{r}
testingtesting123
```
###Tidy Data
```{r}

```
###Analysis
```{r}

```
####Assumptions
```{r}

```
####Plot
```{r}

```
####Test
```{r}

```


##LOODAT
###Tidy Data
```{r}
oiaefjgoierajgoi
```
###Analysis
```{r}

```
####Assumptions
```{r}

```
####Plot
```{r}

```
####Test
```{r}

```

##BRMPS+HiMaize
```{r}

but_wide_HMB <- all_data_wkly %>%
  rename_all(tolower) %>% 
  select(participant_id, semester, supplement_consumed, frequency, quantity_compliant, study_week, butyrate_mean) %>% #keep only columns of interest
  filter(study_week == "week1" | study_week == "week3", quantity_compliant == "yes", frequency == "1xdaily", supplement_consumed == "HiMaize+BRMPS") %>% #keep only weeks of interest, quantity compliant, and 1x
  spread(study_week, butyrate_mean) %>% 
  mutate(delta_butyrate = week3 - week1) #calculate difference in butyrate 

pro_wide_HMB <- all_data_wkly %>%
  rename_all(tolower) %>% 
  select(participant_id, semester, supplement_consumed, frequency, quantity_compliant, study_week, propionate_mean) %>% #keep only columns of interest
  filter(study_week == "week1" | study_week == "week3", quantity_compliant == "yes", frequency == "1xdaily", supplement_consumed == "HiMaize+BRMPS") %>% #keep only weeks of interest, quantity compliant, and 1x
  spread(study_week, propionate_mean) %>% 
  mutate(delta_propionate = week3 - week1) #calculate difference in propionate

delta_but_pro_wide_HMB <- inner_join(x = but_wide_HMB, y = pro_wide_HMB,
                    by = c("participant_id", 
                           "semester", "supplement_consumed","frequency", "quantity_compliant")) %>%
  select(-starts_with("week"))

```
###Tidy Data
###Analysis
####Assumptions
```{r}
nrow(delta_but_pro_wide_HMB) # number of data points

shapiro.test(delta_but_pro_wide_HMB$delta_butyrate) #call column of df with values = vector 
shapiro.test(delta_but_pro_wide_HMB$delta_propionate) #call column of df with values = vector 

ggplot(delta_but_pro_wide_HMB, aes(x=delta_butyrate)) +
  geom_histogram() #histograms show the number of data points (count) at each value
ggplot(delta_but_pro_wide_HMB, aes(x=delta_propionate)) +
  geom_histogram() #histograms show the number of data points (count) at each value

```
####Plot
```{r}
linear_correlation_HMB_plot<-delta_but_pro_wide_HMB %>%
  ggplot(aes(x = delta_butyrate,
             y = delta_propionate)) + 
  geom_point() + #puts data points to match x and y coordinates
  geom_smooth(method = "lm", #used to create a linear best fit line
              se = FALSE) + #hides confidence interval around line 
  xlab("Delta Butyrate (mmol/kg)") + 
  ylab("Delta Propionate (mmol/kg)") 
print(linear_correlation_HMB_plot)

```
####Test
```{r}
HMB_lm <- delta_but_pro_wide_HMB %>%
  lm(delta_butyrate ~ delta_propionate, data = .) #test relationship
summary(HMB_lm) #view results 

# Small .022 p-value indicates significance, and the other H2
```
